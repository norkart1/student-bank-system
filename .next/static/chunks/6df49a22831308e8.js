(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,10160,e=>{"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e.s(["default",()=>t])},16127,e=>{"use strict";let t,r;var s=e.i(43476),a=e.i(71645);function l(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}var n=a.forwardRef((e,t)=>{let{children:r,...l}=e,n=a.Children.toArray(r),i=n.find(d);if(i){let e=i.props.children,r=n.map(t=>t!==i?t:a.Children.count(e)>1?a.Children.only(null):a.isValidElement(e)?e.props.children:null);return(0,s.jsx)(o,{...l,ref:t,children:a.isValidElement(e)?a.cloneElement(e,void 0,r):null})}return(0,s.jsx)(o,{...l,ref:t,children:r})});n.displayName="Slot";var o=a.forwardRef((e,t)=>{let{children:r,...s}=e;if(a.isValidElement(r)){var n;let e,o,i=(n=r,(o=(e=Object.getOwnPropertyDescriptor(n.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?n.ref:(o=(e=Object.getOwnPropertyDescriptor(n,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?n.props.ref:n.props.ref||n.ref);return a.cloneElement(r,{...function(e,t){let r={...t};for(let s in t){let a=e[s],l=t[s];/^on[A-Z]/.test(s)?a&&l?r[s]=(...e)=>{l(...e),a(...e)}:a&&(r[s]=a):"style"===s?r[s]={...a,...l}:"className"===s&&(r[s]=[a,l].filter(Boolean).join(" "))}return{...e,...r}}(s,r.props),ref:t?function(...e){return t=>{let r=!1,s=e.map(e=>{let s=l(e,t);return r||"function"!=typeof s||(r=!0),s});if(r)return()=>{for(let t=0;t<s.length;t++){let r=s[t];"function"==typeof r?r():l(e[t],null)}}}}(t,i):i})}return a.Children.count(r)>1?a.Children.only(null):null});o.displayName="SlotClone";var i=({children:e})=>(0,s.jsx)(s.Fragment,{children:e});function d(e){return a.isValidElement(e)&&e.type===i}var c=e.i(7670);let u=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,x=c.clsx;var h=e.i(47163);let g=(t="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",r={variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}},e=>{var s;if((null==r?void 0:r.variants)==null)return x(t,null==e?void 0:e.class,null==e?void 0:e.className);let{variants:a,defaultVariants:l}=r,n=Object.keys(a).map(t=>{let r=null==e?void 0:e[t],s=null==l?void 0:l[t];if(null===r)return null;let n=u(r)||u(s);return a[t][n]}),o=e&&Object.entries(e).reduce((e,t)=>{let[r,s]=t;return void 0===s||(e[r]=s),e},{});return x(t,n,null==r||null==(s=r.compoundVariants)?void 0:s.reduce((e,t)=>{let{class:r,className:s,...a}=t;return Object.entries(a).every(e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...l,...o}[t]):({...l,...o})[t]===r})?[...e,r,s]:e},[]),null==e?void 0:e.class,null==e?void 0:e.className)});function m({className:e,variant:t,size:r,asChild:a=!1,...l}){let o=a?n:"button";return(0,s.jsx)(o,{"data-slot":"button",className:(0,h.cn)(g({variant:t,size:r,className:e})),...l})}function p({className:e,...t}){return(0,s.jsx)("div",{"data-slot":"card",className:(0,h.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...t})}var f=e.i(55749),b=e.i(70016);function y(){let[e,t]=(0,a.useState)([]),[r,l]=(0,a.useState)("student"),[n,o]=(0,a.useState)(""),[i,d]=(0,a.useState)(null),[c,u]=(0,a.useState)(""),[x,h]=(0,a.useState)(""),[g,y]=(0,a.useState)(""),[v,j]=(0,a.useState)(new Date().getFullYear().toString()),[w,N]=(0,a.useState)([]),[k,S]=(0,a.useState)(!1),[C,D]=(0,a.useState)([]),[F,z]=(0,a.useState)(!1);(0,a.useEffect)(()=>{E()},[]),(0,a.useEffect)(()=>{if(""===n.trim())D([]);else{let t=n.toLowerCase();D(e.filter(e=>e.name.toLowerCase().includes(t)||e.code.toLowerCase().includes(t)||e._id.toLowerCase().includes(t)))}},[n,e]);let E=async()=>{try{let e=await fetch("/api/students"),r=await e.json();t(Array.isArray(r)?r:[])}catch(e){console.error("Failed to fetch students:",e),t([])}},B=(e,t)=>{let r=0;for(let s=0;s<=t;s++){let t=e[s];"deposit"===t.type?r+=t.amount:r-=t.amount}return r};return(0,s.jsx)("div",{className:"min-h-screen bg-gray-100 p-6",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("button",{onClick:()=>window.history.back(),className:"w-12 h-12 bg-slate-600 hover:bg-slate-700 text-white rounded-full flex items-center justify-center mb-6 transition",children:(0,s.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,s.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Find Your"}),(0,s.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Report"}),(0,s.jsx)("p",{className:"text-gray-600 text-base",children:"Search by student, date, month, or year"})]}),(0,s.jsx)(p,{className:"p-8 mb-8 bg-white shadow-lg rounded-3xl",children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{children:(0,s.jsx)("div",{className:"grid grid-cols-2 gap-3 mb-6",children:[{value:"student",label:"By Student"},{value:"date",label:"By Date"},{value:"month",label:"By Month"},{value:"year",label:"By Year"}].map(e=>(0,s.jsx)("button",{onClick:()=>{l(e.value),S(!1),N([])},className:`px-4 py-3 rounded-xl font-medium transition ${r===e.value?"bg-slate-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:e.label},e.value))})}),"student"===r&&(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsxs)("div",{className:"flex-1 relative",children:[(0,s.jsx)("input",{type:"text",placeholder:"e.g., MR-5774",value:n,onChange:e=>o(e.target.value),onFocus:()=>z(!0),className:"w-full px-4 py-3 border-2 border-gray-300 rounded-2xl focus:outline-none focus:border-slate-600 bg-gray-50"}),(0,s.jsx)("svg",{className:"absolute left-4 top-3.5 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),(0,s.jsx)("button",{className:"w-12 h-12 bg-slate-600 hover:bg-slate-700 text-white rounded-2xl flex items-center justify-center transition",children:(0,s.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{d:"M8 4a.5.5 0 0 0-.5.5v7a.5.5 0 0 0 .5.5h7a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.5-.5H8zm0-1h7a1.5 1.5 0 0 1 1.5 1.5v7A1.5 1.5 0 0 1 15 13H8a1.5 1.5 0 0 1-1.5-1.5v-7A1.5 1.5 0 0 1 8 3z"})})})]}),F&&C.length>0&&(0,s.jsx)("div",{className:"absolute top-full left-0 right-0 bg-white border-2 border-gray-300 rounded-2xl mt-2 max-h-48 overflow-y-auto z-10 shadow-lg",children:C.map(e=>(0,s.jsxs)("button",{onClick:()=>{d(e),o(e.name),z(!1)},className:"w-full text-left px-4 py-3 hover:bg-slate-50 border-b border-gray-200 last:border-b-0",children:[(0,s.jsx)("div",{className:"font-semibold text-gray-900",children:e.name}),(0,s.jsx)("div",{className:"text-sm text-gray-600",children:e.code})]},e._id))})]}),"date"===r&&(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Start Date"}),(0,s.jsx)("input",{type:"date",value:c,onChange:e=>u(e.target.value),className:"w-full px-4 py-3 border-2 border-gray-300 rounded-2xl focus:outline-none focus:border-slate-600 bg-gray-50"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"End Date"}),(0,s.jsx)("input",{type:"date",value:x,onChange:e=>h(e.target.value),className:"w-full px-4 py-3 border-2 border-gray-300 rounded-2xl focus:outline-none focus:border-slate-600 bg-gray-50"})]})]}),"month"===r&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Select Month"}),(0,s.jsx)("input",{type:"month",value:g,onChange:e=>y(e.target.value),className:"w-full px-4 py-3 border-2 border-gray-300 rounded-2xl focus:outline-none focus:border-slate-600 bg-gray-50"})]}),"year"===r&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Select Year"}),(0,s.jsx)("select",{value:v,onChange:e=>j(e.target.value),className:"w-full px-4 py-3 border-2 border-gray-300 rounded-2xl focus:outline-none focus:border-slate-600 bg-gray-50",children:[2023,2024,2025,2026].map(e=>(0,s.jsx)("option",{value:e.toString(),children:e},e))})]}),("student"===r&&i||"date"===r&&c&&x||"month"===r&&g||"year"===r)&&(0,s.jsx)("button",{onClick:()=>{let t=[];if("student"===r){if(!i)return;t=i.transactions.map((e,t)=>({...e,index:t}))}else if("date"===r){if(!c||!x)return;let r=new Date(c),s=new Date(x);e.forEach(e=>{e.transactions.forEach((e,a)=>{let l=new Date(e.date||"");l>=r&&l<=s&&t.push({...e,index:a})})})}else if("month"===r){if(!g)return;let[r,s]=g.split("-");e.forEach(e=>{e.transactions.forEach((e,a)=>{let l=new Date(e.date||"");l.getFullYear().toString()===r&&(l.getMonth()+1).toString().padStart(2,"0")===s&&t.push({...e,index:a})})})}else"year"===r&&e.forEach(e=>{e.transactions.forEach((e,r)=>{new Date(e.date||"").getFullYear().toString()===v&&t.push({...e,index:r})})});N(t),S(!0)},className:"w-full px-6 py-3 bg-slate-600 hover:bg-slate-700 text-white font-semibold rounded-2xl transition",children:"Search"})]})}),k&&w.length>0&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)(p,{className:"p-4 bg-white shadow-lg rounded-3xl",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Transaction Ledger"}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full text-sm",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"bg-gradient-to-r from-slate-600 to-slate-700 text-white",children:[(0,s.jsx)("th",{className:"px-2 py-2 text-left font-semibold text-xs",children:"S.No"}),(0,s.jsx)("th",{className:"px-2 py-2 text-left font-semibold text-xs",children:"Date"}),(0,s.jsx)("th",{className:"px-2 py-2 text-right font-semibold text-xs",children:"Deposit"}),(0,s.jsx)("th",{className:"px-2 py-2 text-right font-semibold text-xs",children:"Withdraw"}),(0,s.jsx)("th",{className:"px-2 py-2 text-right font-semibold text-xs",children:"Balance"})]})}),(0,s.jsx)("tbody",{children:w.map((e,t)=>(0,s.jsxs)("tr",{className:"border-b border-gray-200 hover:bg-gray-50 transition",children:[(0,s.jsx)("td",{className:"px-2 py-2 text-gray-700 text-xs",children:t+1}),(0,s.jsx)("td",{className:"px-2 py-2 text-gray-700 text-xs",children:e.date||"N/A"}),(0,s.jsxs)("td",{className:"px-2 py-2 text-right text-xs",children:["deposit"===e.type&&(0,s.jsxs)("span",{className:"text-green-600 font-semibold",children:["₹",e.amount.toFixed(2)]}),"deposit"!==e.type&&(0,s.jsx)("span",{className:"text-gray-400",children:"–"})]}),(0,s.jsxs)("td",{className:"px-2 py-2 text-right text-xs",children:["withdraw"===e.type&&(0,s.jsxs)("span",{className:"text-red-600 font-semibold",children:["₹",e.amount.toFixed(2)]}),"withdraw"!==e.type&&(0,s.jsx)("span",{className:"text-gray-400",children:"–"})]}),(0,s.jsxs)("td",{className:"px-2 py-2 text-right text-gray-900 font-semibold text-xs",children:["₹",B(w,t).toFixed(2)]})]},t))})]})})]}),(0,s.jsxs)(p,{className:"p-6 bg-white shadow-lg rounded-3xl",children:[(0,s.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Download Report"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)(m,{onClick:()=>{if(0===w.length)return;let e=new f.default,t=e.internal.pageSize.getWidth(),s=e.internal.pageSize.getHeight(),a=20;e.setFontSize(16),e.text("Transaction Ledger Report",t/2,a,{align:"center"}),a+=10,e.setFontSize(10),"student"===r&&i?(e.text(`Student: ${i.name} (${i.code})`,20,a),a+=7):"date"===r?(e.text(`Date Range: ${c} to ${x}`,20,a),a+=7):"month"===r?(e.text(`Month: ${g}`,20,a),a+=7):"year"===r&&(e.text(`Year: ${v}`,20,a),a+=7),a+=8,e.setTextColor(255,255,255),e.setFillColor(79,117,135);let l=[15,35,25,25,25],n=20;["S.No","Date","Deposit","Withdraw","Balance"].forEach((t,r)=>{e.rect(n,a-5,l[r],8,"F"),e.text(t,n+l[r]/2,a,{align:"center"}),n+=l[r]}),a+=10,e.setTextColor(0,0,0),e.setFontSize(9),w.forEach((t,r)=>{a>s-20&&(e.addPage(),a=20),n=20;let o=B(w,r),i=t.date||"N/A",d="deposit"===t.type?`₹${t.amount.toFixed(2)}`:"–",c="withdraw"===t.type?`₹${t.amount.toFixed(2)}`:"–";e.text((r+1).toString(),n+l[0]/2,a,{align:"center"}),n+=l[0],e.text(i,n+l[1]/2,a,{align:"center"}),n+=l[1],e.text(d,n+l[2]/2,a,{align:"center"}),n+=l[2],e.text(c,n+l[3]/2,a,{align:"center"}),n+=l[3],e.text(`₹${o.toFixed(2)}`,n+l[4]/2,a,{align:"center"}),a+=7}),e.save(`transaction-ledger-${r}.pdf`)},className:"h-12 bg-slate-600 hover:bg-slate-700 text-white font-semibold rounded-2xl flex items-center justify-center gap-2",children:[(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8m0 0l-4 4m4-4l4 4"})}),"Download PDF"]}),(0,s.jsxs)(m,{onClick:()=>{if(0===w.length)return;let e=w.map((e,t)=>({"S.No":t+1,Date:e.date||"N/A",Deposit:"deposit"===e.type?e.amount:"",Withdraw:"withdraw"===e.type?e.amount:"",Balance:B(w,t)})),t=b.utils.json_to_sheet(e);t["!cols"]=[{wch:8},{wch:15},{wch:12},{wch:12},{wch:12}];let s=b.utils.book_new();b.utils.book_append_sheet(s,t,"Ledger"),b.writeFile(s,`transaction-ledger-${r}.xlsx`)},className:"h-12 bg-slate-600 hover:bg-slate-700 text-white font-semibold rounded-2xl flex items-center justify-center gap-2",children:[(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8m0 0l-4 4m4-4l4 4"})}),"Download Excel"]})]})]})]}),k&&0===w.length&&(0,s.jsx)(p,{className:"p-12 bg-white shadow-lg rounded-3xl text-center",children:(0,s.jsx)("p",{className:"text-gray-600 text-lg",children:"No transactions found for the selected criteria."})})]})})}e.s(["default",()=>y],16127)},48503,e=>{e.v(t=>Promise.all(["static/chunks/01095d914547b2b6.js"].map(t=>e.l(t))).then(()=>t(15833)))},70653,e=>{e.v(t=>Promise.all(["static/chunks/90fdd386fff6c4e1.js"].map(t=>e.l(t))).then(()=>t(24154)))},95111,e=>{e.v(t=>Promise.all(["static/chunks/cca5a266ceb00b0d.js"].map(t=>e.l(t))).then(()=>t(38201)))}]);