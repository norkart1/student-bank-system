{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 136, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/lib/pusher.ts"],"sourcesContent":["import Pusher from 'pusher';\nimport PusherJs from 'pusher-js';\n\n// Server-side Pusher instance\nexport const pusher = new Pusher({\n  appId: process.env.NEXT_PUBLIC_PUSHER_APP_ID || '',\n  key: process.env.NEXT_PUBLIC_PUSHER_KEY || '',\n  secret: process.env.PUSHER_SECRET || '',\n  cluster: process.env.NEXT_PUBLIC_PUSHER_CLUSTER || 'mt1',\n  useTLS: true,\n});\n\n// Client-side Pusher instance\nexport const getPusherClient = () => {\n  if (typeof window === 'undefined') return null;\n  \n  const pusherClient = new PusherJs(\n    process.env.NEXT_PUBLIC_PUSHER_KEY || '',\n    {\n      cluster: process.env.NEXT_PUBLIC_PUSHER_CLUSTER || 'mt1',\n      forceTLS: true,\n    }\n  );\n  \n  return pusherClient;\n};\n\n// Channel names\nexport const CHANNELS = {\n  STUDENTS: 'students',\n  BALANCE_UPDATE: (studentId: string) => `balance-${studentId}`,\n  ADMIN: 'admin-channel',\n};\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;;;AAGO,MAAM,SAAS,IAAI,oJAAM,CAAC;IAC/B,OAAO,+CAAyC;IAChD,KAAK,4DAAsC;IAC3C,QAAQ,QAAQ,GAAG,CAAC,aAAa,IAAI;IACrC,SAAS,2CAA0C;IACnD,QAAQ;AACV;AAGO,MAAM,kBAAkB;IAC7B,wCAAmC,OAAO;;;IAE1C,MAAM;AASR;AAGO,MAAM,WAAW;IACtB,UAAU;IACV,gBAAgB,CAAC,YAAsB,CAAC,QAAQ,EAAE,WAAW;IAC7D,OAAO;AACT"}},
    {"offset": {"line": 170, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/api/pusher/broadcast/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { pusher, CHANNELS } from '@/lib/pusher';\n\nexport async function POST(req: NextRequest) {\n  try {\n    const data = await req.json();\n    const { type, studentId, update } = data;\n\n    if (!type) {\n      return NextResponse.json(\n        { error: 'Missing broadcast type' },\n        { status: 400 }\n      );\n    }\n\n    // Broadcast different types of updates\n    if (type === 'balance-update' && studentId && update) {\n      // Notify specific student of balance change\n      await pusher.trigger(\n        CHANNELS.BALANCE_UPDATE(studentId),\n        'balance-changed',\n        update\n      );\n    } else if (type === 'students-list-update') {\n      // Notify admin of student list changes\n      await pusher.trigger(\n        CHANNELS.STUDENTS,\n        'list-updated',\n        { timestamp: new Date().toISOString() }\n      );\n    } else if (type === 'transaction-added' && studentId) {\n      // Notify student of new transaction\n      await pusher.trigger(\n        CHANNELS.BALANCE_UPDATE(studentId),\n        'transaction-added',\n        update\n      );\n    }\n\n    return NextResponse.json({ success: true });\n  } catch (error) {\n    console.error('Pusher broadcast error:', error);\n    return NextResponse.json(\n      { error: 'Broadcast failed' },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,KAAK,GAAgB;IACzC,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,MAAM,EAAE,GAAG;QAEpC,IAAI,CAAC,MAAM;YACT,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAyB,GAClC;gBAAE,QAAQ;YAAI;QAElB;QAEA,uCAAuC;QACvC,IAAI,SAAS,oBAAoB,aAAa,QAAQ;YACpD,4CAA4C;YAC5C,MAAM,yHAAM,CAAC,OAAO,CAClB,2HAAQ,CAAC,cAAc,CAAC,YACxB,mBACA;QAEJ,OAAO,IAAI,SAAS,wBAAwB;YAC1C,uCAAuC;YACvC,MAAM,yHAAM,CAAC,OAAO,CAClB,2HAAQ,CAAC,QAAQ,EACjB,gBACA;gBAAE,WAAW,IAAI,OAAO,WAAW;YAAG;QAE1C,OAAO,IAAI,SAAS,uBAAuB,WAAW;YACpD,oCAAoC;YACpC,MAAM,yHAAM,CAAC,OAAO,CAClB,2HAAQ,CAAC,cAAc,CAAC,YACxB,qBACA;QAEJ;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAK;IAC3C,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,2BAA2B;QACzC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAmB,GAC5B;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}